exit
merchants.select("merchants.*, count(invoices.merchant_id) AS invoice_count").joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id").order("invoice_count DESC").first
merchants.select("merchants.*, count(invoices.merchant_id) AS invoice_count").joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id").order("invoice_count DESC")
merchants.select("merchants.*, count(invoices.merchant_id) AS invoice_count").joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id")
merchants.select("merchants.*, count(invoices.merchant_id)").joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id")
merchants.select("merchants.*, count(merchants.invoice_id)").joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id")
merchants.select("merchants.*").joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id")
merchants.joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id")
merchants.select("merchants.* count(invoices.merchant_id) AS invoice_count").joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id").order("invoice_count DESC")
merchants.joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id")
merchants.select("merchants.* ").joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id").order("invoice_count DESC")
merchants.joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id")
merchants.joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id").order("invoice_count DESC")
merchants.joins(invoices: :transactions).merge(Transaction.successful).group("merchants.id")
merchants.joins(invoices: :transactions).merge(Transaction.successful)
merchants.joins(invoices: :transactions)
